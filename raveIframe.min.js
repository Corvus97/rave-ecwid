var loadedConfig = { testSecretKey: "", testPublicKey: "", liveSecretKey: "", livePublicKey: "", logo: "", country: "", pm: "", env: "", delay: "" }, initialConfig = { testSecretKey: "", testPublicKey: "", liveSecretKey: "", livePublicKey: "", logo: "", country: "", pm: "", env: !1, delay: 0 }; function httpGet(e) { var t = new XMLHttpRequest; return t.open("GET", e, !1), t.send(null), t.responseText } function createUserData() { var e = httpGet("https://app.ecwid.com/api/v3/" + storeId + "/profile?token=" + accessToken); e = JSON.parse(e), initialConfig.testSecretKey = "", initialConfig.testPublicKey = "", initialConfig.liveSecretKey = "", initialConfig.livePublicKey = "", initialConfig.logo = "", initialConfig.country = "ng", initialConfig.pm = "both", initialConfig.env = !1, initialConfig.delay = 0; var t = '{"testSecretKey": "' + initialConfig.testSecretKey + '", "testPublicKey": "' + initialConfig.testPublicKey + '", "liveSecretKey": "' + initialConfig.liveSecretKey + '", "livePublicKey": "' + initialConfig.livePublicKey + '", "logo": "' + initialConfig.logo + '", "country": "' + initialConfig.country + '", "pm": "' + initialConfig.pm + '", "env": ' + initialConfig.env + ', "delay":' + initialConfig.delay + "}"; EcwidApp.setAppPublicConfig(t, function () { console.log("Public config saved!") }), document.getElementById("testSecretKey").value = initialConfig.testSecretKey, document.getElementById("testPublicKey").value = initialConfig.testPublicKey, document.getElementById("liveSecretKey").value = initialConfig.liveSecretKey, document.getElementById("livePublicKey").value = initialConfig.livePublicKey, document.getElementById("country").value = initialConfig.country, document.getElementById("pm").value = initialConfig.pm, document.getElementById("env").checked = initialConfig.env, document.querySelector("#testPub").style.display = "block", document.querySelector("#testSec").style.display = "block", document.querySelector("#test-keys").style.display = "block", document.querySelector("#livePK").disabled = !0, document.querySelector("#liveSK").disabled = !0, document.querySelector("#livePub").style.display = "none", document.querySelector("#liveSec").style.display = "none", document.querySelector("#live-keys").style.display = "none", document.getElementById("delay").value = initialConfig.delay; EcwidApp.setAppStorage({ exists: "yes" }, function () { console.log("Data saved!") }) } function getUserData() { EcwidApp.getAppStorage("public", function (e) { e = JSON.parse(e), loadedConfig.testSecretKey = e.testSecretKey, loadedConfig.testPublicKey = e.testPublicKey, loadedConfig.liveSecretKey = e.liveSecretKey, loadedConfig.livePublicKey = e.livePublicKey, loadedConfig.logo = e.logo, loadedConfig.country = e.country, loadedConfig.pm = e.pm, loadedConfig.env = e.env, loadedConfig.delay = e.delay }), setTimeout(function () { document.getElementById("testSecretKey").value = loadedConfig.testSecretKey, document.getElementById("testSecretKey").disabled = loadedConfig.env, document.getElementById("testPublicKey").value = loadedConfig.testPublicKey, document.getElementById("testPublicKey").disabled = loadedConfig.env, document.getElementById("liveSecretKey").value = loadedConfig.liveSecretKey, document.getElementById("liveSecretKey").disabled = !loadedConfig.env, document.getElementById("livePublicKey").value = loadedConfig.livePublicKey, document.getElementById("livePublicKey").disabled = !loadedConfig.env, document.getElementById("country").value = loadedConfig.country, document.getElementById("pm").value = loadedConfig.pm, document.getElementById("logo").value = loadedConfig.logo, document.getElementById("env").checked = loadedConfig.env, document.getElementById("delay").value = loadedConfig.delay, loadedConfig.env ? (document.querySelector("#testPub").style.display = "none", document.querySelector("#testSec").style.display = "none", document.querySelector("#test-keys").style.display = "none", document.querySelector("#livePub").style.display = "block", document.querySelector("#liveSec").style.display = "block", document.querySelector("#live-keys").style.display = "block") : (document.querySelector("#testPub").style.display = "block", document.querySelector("#testSec").style.display = "block", document.querySelector("#test-keys").style.display = "block", document.querySelector("#livePub").style.display = "none", document.querySelector("#liveSec").style.display = "none", document.querySelector("#live-keys").style.display = "none") }, 1e3) } function saveUserData() { var e = document.getElementById("save"); e.className += " btn-loading", setTimeout(function () { e.className = "btn btn-primary btn-large" }, 500); var t = { testSecretKey: loadedConfig.testSecretKey, testPublicKey: loadedConfig.testPublicKey, liveSecretKey: loadedConfig.liveSecretKey, livePublicKey: loadedConfig.livePublicKey, logo: loadedConfig.logo, country: loadedConfig.country, pm: loadedConfig.pm, env: loadedConfig.env, delay: loadedConfig.delay }; t.testSecretKey = document.getElementById("testSecretKey").value, t.testPublicKey = document.getElementById("testPublicKey").value, t.liveSecretKey = document.getElementById("liveSecretKey").value, t.livePublicKey = document.getElementById("livePublicKey").value, t.logo = document.getElementById("logo").value, t.country = document.getElementById("country").value, t.pm = document.getElementById("pm").value, t.env = document.getElementById("env").checked, isNaN(t.delay) && (t.delay = 0); var l = '{"name": "Rave", "testSecretKey": "' + t.testSecretKey + '", "testPublicKey": "' + t.testPublicKey + '", "liveSecretKey": "' + t.liveSecretKey + '", "livePublicKey": "' + t.livePublicKey + '", "logo": "' + t.logo + '", "country": "' + t.country + '", "pm": "' + t.pm + '", "env": ' + t.env + ', "delay":' + t.delay + "}", i = document.getElementById("env").checked, n = { environment: i, testPublicKey: document.getElementById("testPublicKey").value, testSecretKey: document.getElementById("testSecretKey").value, livePublicKey: document.getElementById("livePublicKey").value, liveSecretKey: document.getElementById("liveSecretKey").value, logo: document.getElementById("logo").value, country: document.getElementById("country").value, pm: document.getElementById("pm").value }; console.log(i), EcwidApp.setAppStorage(n, function () { }), EcwidApp.setAppPublicConfig(l, function () { }) } EcwidApp.getAppStorage("exists", function (e) { null != e ? getUserData() : createUserData() });